webpackJsonp([1],{"0H5r":function(t,e){},"4n+7":function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n=s("NYxO"),r=s("Xxa5"),o=s.n(r),i=s("exGp"),c=s.n(i),l={name:"NavBar",data:function(){return{msg:"OTA Server Admin Content"}},methods:{logout:function(){var t=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("logout");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}},e,t,[[0,5]])}))()}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top"},[t._m(0,!1,!1),t._v(" "),s("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v("OTA Admin")]),t._v(" "),s("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarsExampleDefault"}},[s("ul",{staticClass:"navbar-nav mr-auto"},[s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Home")])],1),t._v(" "),s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/secretsMng"}},[t._v("Secrets Manage")])],1),t._v(" "),this.$store.state.authUser?t._e():s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/login"}},[t._v("Login")])],1),t._v(" "),this.$store.state.authUser?s("li",{staticClass:"nav-item"},[s("div",{staticClass:"logout",on:{click:t.logout}},[t._v("Logout")])]):t._e()])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"navbar-toggler navbar-toggler-right",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarsExampleDefault","aria-controls":"navbarsExampleDefault","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])}]},d=s("VU/8")(l,u,!1,function(t){s("hyKu")},null,null).exports,m={render:function(){this.$createElement;this._self._c;return this._m(0,!1,!1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("footer",[e("span",[this._v("© CoolbitX")])])}]},v=s("VU/8")({name:"Footer"},m,!1,function(t){s("e2zj")},null,null).exports,f=s("mtWM"),p=s.n(f),h=s("7t+N"),_=s.n(h);window.$=window.jQuery=_.a;var g={name:"Modal",methods:{doSave:function(){var t=this;return c()(o.a.mark(function e(){var s,a,n,r,i,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.$("#processModal").modal("show"),s=window.$("form.upsertContent input[name='userId']").val(),a=window.$("form.upsertContent input[name='keyNum']").val(),n=window.$("form.upsertContent input[name='secret']").val(),r=t.$store.state.token,e.next=7,p.a.post("/api/modifySecret",{userId:s,keyNum:a,secret:n,token:r});case 7:return i=e.sent,c=i.data,console.log(c.data[0]),e.next=12,t.$store.dispatch("setToken",c.data[0]);case 12:return e.next=14,t.$store.dispatch("fetchSecrets");case 14:window.$("#myModal").modal("hide"),setTimeout(t.closeWindow,2e3);case 16:case"end":return e.stop()}},e,t)}))()},closeWindow:function(){window.$("#processModal").modal("hide")}}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal modal-static fade",attrs:{id:"myModal","data-backdrop":"static","data-keyboard":"false"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[this._m(0,!1,!1),this._v(" "),this._m(1,!1,!1),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",on:{click:this.doSave}},[this._v("Save")]),this._v(" "),e("button",{staticClass:"btn btn-secondary",attrs:{"data-dismiss":"modal"}},[this._v("Close")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"}),this._v(" "),e("button",{staticClass:"close",attrs:{"data-dismiss":"modal"}},[this._v("×")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-body"},[e("form",{staticClass:"upsertContent"},[e("input",{attrs:{type:"hidden",name:"userId"}}),this._v(" "),e("input",{attrs:{type:"hidden",name:"keyNum"}}),this._v(" "),e("label",{attrs:{for:"secret"}},[this._v("Secret:")]),e("input",{staticClass:"form-control",attrs:{type:"text",name:"secret",placeholder:"secret"}})])])}]},b={render:function(){this.$createElement;this._self._c;return this._m(0,!1,!1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal modal-static fade",staticStyle:{"padding-top":"15%","overflow-y":"visible"},attrs:{id:"processModal","data-backdrop":"static","data-keyboard":"false",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("div",{staticClass:"progress active",staticStyle:{"margin-bottom":"0"}},[e("div",{staticClass:"progress-bar progress-bar-striped",staticStyle:{width:"100%"}})])])])])])}]},C={name:"app",components:{navbar:d,myfooter:v,modal:s("VU/8")(g,w,!1,null,null,null).exports,"processing-modal":s("VU/8")({name:"ProcessingModal"},b,!1,null,null,null).exports},beforeCreate:function(){console.log(this.$store)},created:function(){},mounted:function(){this.$store.dispatch("fetchSessions")}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("navbar"),this._v(" "),e("router-view"),this._v(" "),e("myfooter"),this._v(" "),e("modal"),this._v(" "),e("processing-modal")],1)},staticRenderFns:[]},k=s("VU/8")(C,S,!1,null,null,null).exports,x=s("/ocq"),E={render:function(){this.$createElement;this._self._c;return this._m(0,!1,!1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",{staticClass:"starter-template"},[e("h1",[this._v("OTA Management Portal")]),this._v(" "),e("p",{staticClass:"lead"})])])}]},$=s("VU/8")({name:"Home"},E,!1,function(t){s("0H5r")},null,null).exports;window.$=window.jQuery=_.a;var y={name:"Cards",props:{secretsList:{}},methods:{openModal:function(t){console.log(t),window.$("#myModal .modal-title").text("Modify Secret"),this.setupModal(t),window.$("#myModal").modal("show")},setupModal:function(t){var e="card"+t,s=window.$("#"+e+" .card-title[name='userId']").text(),a=window.$("#"+e+" .card-title[name='keyNum']").text(),n=window.$("#"+e+" .card-title[name='secret']").text();window.$(".upsertContent input[name='userId']").val(s),window.$(".upsertContent input[name='keyNum']").val(a),window.$(".upsertContent input[name='secret']").val(n)}}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card card-inverse"},t._l(t.secretsList,function(e,a){return s("div",{key:a,staticClass:"card-block",staticStyle:{"background-color":"rgb(51, 51, 51)","border-color":"rgb(51, 51, 51)"},attrs:{id:"card"+a,secretsList:t.secretsList}},[s("div",{staticClass:"inLine"},[s("label",{attrs:{for:"userId"}},[t._v("userId:")]),s("div",{staticClass:"card-title",attrs:{name:"userId"}},[t._v(t._s(e.userId))])]),t._v(" "),s("div",{staticClass:"inLine"},[s("label",{attrs:{for:"keyNum"}},[t._v("keyNum:")]),s("div",{staticClass:"card-title",attrs:{name:"keyNum"}},[t._v(t._s(e.keyNum))])]),t._v(" "),s("div",{staticClass:"inLine"},[s("label",{attrs:{for:"secret"}},[t._v("secret:")]),s("div",{staticClass:"card-title",attrs:{name:"secret"}},[t._v(t._s(e.secret))])]),t._v(" "),s("div",{staticClass:"inLine"},[s("label",{attrs:{for:"time"}},[t._v("time:")]),s("div",{staticClass:"card-title",attrs:{name:"time"}},[t._v(t._s(new Date(e.modifiedDate).toLocaleString()))])]),t._v(" "),s("button",{staticClass:"btn btn-primary",on:{click:function(e){t.openModal(a)}}},[t._v("Modify Secrets")])])}))},staticRenderFns:[]},U={name:"SecretsManage",components:{cards:s("VU/8")(y,T,!1,function(t){s("rN8n")},null,null).exports},methods:{getSecrets:function(){var t=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("fetchSecrets");case 2:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("fetchSessions");case 2:return e.next=4,t.$store.dispatch("fetchSecrets");case 4:t.$store.state.authUser||(window.location.href="/login");case 5:case"end":return e.stop()}},e,t)}))()},computed:{secretsList:function(){return this.$store.state.secretsList}}},M={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("h2",[this._v("Secret Management")]),this._v(" "),e("cards",{attrs:{secretsList:this.secretsList}})],1)},staticRenderFns:[]},N=s("VU/8")(U,M,!1,function(t){s("4n+7")},null,null).exports,L={name:"Login",computed:{isLogin:function(){return this.$store.state.authUser}},data:function(){return{formError:null,formUsername:null,formPasswd:null}},methods:{login:function(){var t=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.formUsername,t.formPasswd),e.prev=1,e.next=4,t.$store.dispatch("login",{username:t.formUsername,passwd:t.formPasswd});case 4:t.formUsername=null,t.formPasswd=null,t.$store.state.authUser&&(window.location.href="/secretsMng"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),t.formError=e.t0.message;case 13:case"end":return e.stop()}},e,t,[[1,9]])}))()}}},R={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[this.isLogin?t._e():s("form",{staticClass:"form-signin",on:{submit:function(e){e.preventDefault(),t.login(e)}}},[t.formError?s("p",{staticClass:"error"},[t._v(t._s(t.formError))]):t._e(),t._v(" "),s("h2",{staticClass:"form-signin-heading"},[t._v("Please sign in")]),t._v(" "),s("label",{staticClass:"sr-only",attrs:{for:"username"}},[t._v("Username")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.formUsername,expression:"formUsername"}],staticClass:"form-control",attrs:{type:"text",name:"username",placeholder:"User name",required:"",autofocus:""},domProps:{value:t.formUsername},on:{input:function(e){e.target.composing||(t.formUsername=e.target.value)}}}),t._v(" "),s("label",{staticClass:"sr-only",attrs:{for:"passwd"}},[t._v("Password")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.formPasswd,expression:"formPasswd"}],staticClass:"form-control",attrs:{type:"password",name:"passwd",placeholder:"Password",required:""},domProps:{value:t.formPasswd},on:{input:function(e){e.target.composing||(t.formPasswd=e.target.value)}}}),t._v(" "),t._m(0,!1,!1),t._v(" "),s("button",{staticClass:"btn btn-lg btn-primary btn-block"},[t._v("Sign in")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"checkbox"},[e("label",[e("input",{attrs:{type:"checkbox",value:"remember-me"}}),this._v(" Remember me\n      ")])])}]},I=s("VU/8")(L,R,!1,function(t){s("n5ek")},null,null).exports;a.a.use(x.a);var P=new x.a({routes:[{path:"/",name:"Home",component:$},{path:"/secretsMng",name:"SecretsManage",component:N},{path:"/login",name:"Login",component:I}],mode:"history",base:"/"}),O=(s("K3J8"),s("Jmt5"),s("18Sv")),A=s.n(O);a.a.use(n.a),a.a.use(A.a);var F=function(){return new n.a.Store({actions:{login:function(t,e){var s=this,a=t.commit,n=e.username,r=e.passwd;return c()(o.a.mark(function t(){var e,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n,r),t.prev=1,t.next=4,p.a.post("/api/user",{username:n,passwd:r,number:1}).then(function(t){return t});case 4:e=t.sent,i=e.data,window.localStorage.setItem("username",n),a("SET_USER",i),a("SET_TOKEN",i),t.next=19;break;case 11:if(t.prev=11,t.t0=t.catch(1),!t.t0.response||401!==t.t0.response.status){t.next=15;break}throw new Error("Bad credentiasl");case 15:if(!t.t0.response||403!==t.t0.response.status){t.next=17;break}throw new Error("Need to Activated");case 17:throw console.log(t.t0.message),t.t0;case 19:case"end":return t.stop()}},t,s,[[1,11]])}))()},logout:function(t){var e=this,s=t.commit;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.post("/api/logout");case 2:window.localStorage.removeItem("username"),s("SET_USER",null);case 4:case"end":return t.stop()}},t,e)}))()},fetchSecrets:function(t){var e=this,s=t.commit;return c()(o.a.mark(function t(){var a,n,r,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("fetchSecret",e.state.token),a=e.state.token,t.next=4,p.a.get("/api/getAllSecrets",{headers:{"x-access-token":a}});case 4:n=t.sent,r=n.data,console.log(r.data),i=r.data,s("SET_SECRETS_LIST",i);case 9:case"end":return t.stop()}},t,e)}))()},setToken:function(t,e){var s=this,a=t.commit;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a("SET_TOKEN",e);case 1:case"end":return t.stop()}},t,s)}))()},fetchSessions:function(t){var e=this,s=t.commit;return c()(o.a.mark(function t(){var a,n,r,i,c;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=window.localStorage.getItem("username")||null,console.log(a),t.next=4,p.a.post("/api/sessionsStatus",{username:a});case 4:n=t.sent,r=n.data,i=r.session,console.log(i),s("SET_SESSION",i),s("SET_USER",i),i&&(c=i.token,console.log(c),s("SET_TOKEN",i));case 11:case"end":return t.stop()}},t,e)}))()}},state:{authUser:null,token:null,registerStatus:null,isProcessing:!1,isDialogShow:!1,dialogMsg:null,session:null,secretsList:null},mutations:{SET_USER:function(t,e){t.authUser=e},SET_TOKEN:function(t,e){var s=e.token;console.log("SET_TOKEN",s),t.token=s},SET_REGISTER_STATUS:function(t,e){t.registerStatus=e},SET_SESSION:function(t,e){t.session=e},SET_SECRETS_LIST:function(t,e){t.secretsList=e}},getters:{getSecrets:function(t){return t.secretsList}}})}(),K={store:F,install:function(t,e){t.prototype.$store=F}},V=s("KGmM"),D=s.n(V);a.a.config.productionTip=!1,a.a.use(n.a),a.a.use(K),a.a.use(D.a),new a.a({el:"#app",router:P,template:"<App/>",components:{App:k}})},e2zj:function(t,e){},hyKu:function(t,e){},n5ek:function(t,e){},rN8n:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.555d4cdd3fcd298243dc.js.map